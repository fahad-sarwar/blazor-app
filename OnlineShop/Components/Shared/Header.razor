﻿@using OnlineShopUI.ViewModels
@inject NavigationManager Navigation
@using Microsoft.AspNetCore.Components.Forms
@using OnlineShopUI.ViewModels
@rendermode InteractiveServer

<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
    <a class="navbar-brand" href="/">Bob Kart</a>

    <form class="d-flex ms-3 me-auto" @onsubmit="HandleSearch" style="width: 40%;">
        <input class="form-control me-2" @bind="SearchTerm" type="search" placeholder="Search..." />
        <button class="btn btn-outline-light" type="submit">Search</button>
    </form>

    <ul class="navbar-nav d-flex flex-row gap-3">
        @foreach (var link in HeaderLinks)
        {
            <li class="nav-item">
                <NavLink class="nav-link" href="@link.Url">@link.Text</NavLink>
            </li>
        }
    </ul>
</nav>

@code {

    private List<NavLinkItemViewModel> HeaderLinks = new()
    {
        new() { Text = "My Account", Url = "/account" },
        new() { Text = "Wish List", Url = "/wishlist" },
        new() { Text = "Basket", Url = "/cart" }
    };

    private string SearchTerm = string.Empty;

    private Task HandleSearch()
    {
        if (!string.IsNullOrWhiteSpace(SearchTerm))
        {
            var encoded = Uri.EscapeDataString(SearchTerm);
            Navigation.NavigateTo($"/search-results/{encoded}");
        }

        return Task.CompletedTask;
    }
}